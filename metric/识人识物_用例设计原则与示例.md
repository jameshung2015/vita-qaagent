# 识人找物 — 用例设计原则与示例（V0.1）

参考文件：`NM SOR.md`、`NM_Acceptance_Checklist v1.2.md`、`识人找物 PRD`、`物品识别_用例设计原则与示例.md`

## 设计原则（从输入/输出/场景/操作方法拆解）

1) 维度分析
- 语音：
  - 问法覆盖人物指代（我/主驾/副驾/后排左/孩子/朋友等）、关系指代（爸爸/同事/同学等）、空间指代（左边/右边/前排/后排）、物品指代（包/手机/水杯等）；
  - 问法覆盖属性（服装颜色/类型、配饰、情绪、人数、物品数量等）与组合指代（“副驾戴帽子的那个人”“我左边的小朋友”）；
- 视觉：
  - OMS 原子能力（占座、性别、年龄段、座位位置、安全带、情绪、服装类型/颜色、配饰等）；
  - 多模态大模型融合结果（人物+物品+行为/姿态）；
  - 光线、遮挡（座椅/屏幕）、清晰度、多座位同时存在等变化；
- 上下文/记忆：
  - FaceID 与昵称/称呼绑定、关系信息（家人/朋友）、历史迎宾与对话记录；
  - 近期对话上下文中的指代（“他”“刚才的那个小朋友”“前排那位”）。

2) 输出约束可测
- 人物/物品回答：
  - 必须包含被问询对象的可识别指代（优先昵称，其次座位/位置+小朋友等）；
  - 回答需覆盖用户问题中的核心属性（如颜色/服装类型/情绪/数量/位置等），或在无法识别时明确兜底，不编造；
- 话术与长度：
  - 识人问答：≤50 字，不超过 5 句话；
  - 找物/识物类回答：≤70 字；
  - 风格、称呼、人设与现有语音助手「小魏同学」保持一致；
- 错误与不确定性处理：
  - 未识别到人物/物品、光线或遮挡导致结果不可靠时，使用统一兜底话术（参考 PRD 中拒识话术），不得捏造身份、关系或敏感属性；
  - 置信度低于阈值时，宁可拒识或给出模糊表述，也不误导用户（例如“不太确定”“目前看不清”）。

3) 场景覆盖分层
- 环境与状态：
  - 静止 vs 行驶；白天/夜晚/逆光；安静（45–50dB）vs 高噪（65–85dB）；
  - 单人/多人（含至少 1 名儿童的场景），乘员上/下车、换位、倾斜、横躺等姿态变化；
- 功能粒度：
  - 仅识人（外观/情绪/位置/人数等）；仅找物（包/手机/水杯等）；人+物组合（“副驾手里拿着什么”）；
  - 端侧直答 vs 云侧多模态推理；弱网/断网/云超时下的回退策略（优先使用端侧记忆与 OMS 能力）；
- 复杂度分层：
  - 单目标简单问题（“我今天衣服什么颜色”）；
  - 多目标统计（“后排有几个人”“车里有几个包”）；
  - 组合指代与模糊问法（“副驾左边的小朋友开心吗”“看看包放哪了”）。

4) 操作方法清晰
- 发起方式：
  - 统一通过语音链路触发，支持小魏/自定义唤醒词；
  - 明确与现有语音车控/对话的优先级不冲突（不打断当前语音交互）；
- 感知与推理：
  - 通过音区定位确定发起者位置；
  - 抽取人物/物品/空间/关系等槽位，结合多模态输入与记忆进行推理；
- HMI 与反馈：
  - 必要时在屏幕上以非强打扰方式展示识别到的乘员/物品概况（数量/位置），但不依赖用户额外操作即可完成主要对话；
  - 关键错误场景需在日志中有可追踪标记，方便回放与问题定位。

5) 可重复与量化
- 为每类问法定义：
  - 规范的输入样例（语音文本）、预期输出要点（必须包含的属性/指代）、允许偏差范围；
  - 识别失败/不确定时的期望兜底行为；
- 指标可量化：
  - 人物属性识别准确率（性别/年龄段/座位/服装/配饰/情绪等）；
  - 物品识别准确率（类别/属性/数量）；
  - 问题理解准确率（意图/槽位/指代解析）；
  - 响应时间（端侧推理/云侧推理/整体 TTI）；
  - 拒识准确率与拒识召回率、敏感内容拒识率；
- 日志字段统一：
  - 记录输入文本、关键图像来源（摄像头 ID）、识别结果（人物/物品/属性）、置信度、是否使用端侧/云侧、响应时间、兜底原因等。

---

## 指标记录与用例通过准则
- 通过条件：
  - 输出与用户意图匹配，人物/物品指代清晰；
  - 话术字数与风格满足 PRD 约束，与「小魏同学」人设一致；
  - 关键属性（颜色/服装/配饰/情绪/数量/位置等）命中，或在无法识别时走规范兜底话术；
  - 不输出隐私、歧视或不当评价（避免涉及精确年龄、收入、身体缺陷等敏感维度）。
- 关键指标：
  - 识人/识物准确率≥ PRD/SOR 要求（参考《NM_Acceptance_Checklist v1.2.md》中的对应条目）；
  - 指代解析正确率、问题理解准确率、整体任务完成率；
  - 接口/整体响应时间满足 PRD 要求（识人问答/找物问答/组合问答场景分别统计）；
  - 敏感内容拒识率、兜底话术合理率；
- 采集方式：
  - 统一多模态日志方案，在端侧与云侧统一 Session/Trace ID，字段满足验收清单中 MOD/FUN/EXP 指标统计需求；
  - 聚合到阶段性版本报告与 SOP 验收报告中，按功能/模型维度拆分统计。

---

## 测试数据准备要求
- 人员维度：
  - 年龄段：儿童、青年、中年、老年均需覆盖；
  - 性别：男女均衡；
  - 形象多样：不同身高/体型、不同发型/发色、不同穿衣风格；
  - 配饰组合：眼镜/帽子/口罩/围巾等单独佩戴与多种组合佩戴；
- 姿态与位置：
  - 主驾/副驾/二排左/中/右等全部座位；
  - 正坐、侧身、低头、抬头、趴睡、横躺、弯腰系鞋带等多种姿态；
  - 座椅前后/靠背调整导致的身体遮挡变化；
- 服装与颜色：
  - 不同季节服饰（T 恤/衬衫/外套/羽绒服/连帽衫等）；
  - 主流颜色组合（黑/白/红/蓝/灰等），避免样本过度集中于单一颜色；
- 情绪与状态：
  - 平静、高兴、悲伤等情绪样本，覆盖不同光线与角度；
- 物品与场景：
  - 手机、平板、笔记本、背包、手提包、雨伞、水杯、书籍、儿童座椅、毛绒玩具、篮球、足球等 PRD 列出的物品；
  - 单物品、≤3 个混合物品、>3 个复杂物品场景，物品与人物的手持/腿上/座椅上/脚边等不同位置摆放；
- 环境与光线：
  - 白天/夜晚/隧道/地下车库等环境；
  - 光线充足、偏暗、逆光、局部炫目、镜头轻微模糊等多种组合；
- 网络与链路：
  - 网络良好、弱网、高延迟、断网等场景，验证端侧/云侧切换与兜底表现；
- 标注与合规：
  - 为每条样本提供人物/物品的结构化标注（位置、类别、属性、情绪等），以及问法与期望回答要点；
  - 含人脸/隐私样本需具备授权与脱敏方案，云端使用样本需加密存储、传输，并支持按需删除与审计记录；
- 指标统计支持：
  - 数据集按功能维度拆分（识人、识物、识人+找物、关系指代等），保证每类功能在样本量上可独立统计准确率与响应时间；
  - 样本中应包含一定比例的困难/边界场景（遮挡、模糊、极端光线等），用于评估兜底话术与鲁棒性。

## 模块划分
模块 (Module) | 用例库建设要求 | 重点覆盖
- VLM (多模态/物品) | 覆盖各类物品(SOR清单)、车内外场景、手势与行为识别。需包含不同光照与遮挡条件。 | 位置准确性 (左/右/后排区分)、小物体/Logo识别、VLM与问答的结合。
- FaceID (识人/迎宾) | 覆盖人脸注册、属性识别(年龄/配饰)、迎宾触发逻辑。需包含单人/多人场景。 | 位置变动 (换座后识别)、多人识别准确性、迎宾频次控制 (避免重复打扰)。
- 语音 (Voice/链路) | 领域分发(落域)，播报内容。需包含噪声环境测试。 | 锁域策略 (多轮对话中不跳域)、误唤醒/误接话、首字延迟体验。
- LLM (意图/问答) | 覆盖意图理解、知识问答、任务规划、闲聊。需包含敏感话题拒识。 | 多轮对话上下文 (指代消解)、幻觉检测 (一本正经胡说八道)、响应超时处理。
- 记忆系统 (Memory) | 覆盖画像建立、偏好读写、历史记忆调用。需包含跨Session测试。 | 记忆同步 (注册后立即生效)、记忆冲突处理、隐私删除验证。


